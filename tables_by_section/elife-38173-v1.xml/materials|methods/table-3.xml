<table-wrap xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" id="inlinetable3" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th colspan="3">Algorithm 3: S<sc>eeded</sc>I<sc>nitialization</sc></th></tr></thead><tbody><tr valign="top"><td colspan="3"><bold>Require:</bold> Input data matrix <inline-formula><mml:math id="inf269"><mml:mi>Y</mml:mi></mml:math></inline-formula>, matrix of binary masks <inline-formula><mml:math id="inf270"><mml:mi>M</mml:mi></mml:math></inline-formula>, number of background components <inline-formula><mml:math id="inf271"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>1:</td><td><inline-formula><mml:math id="inf272"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mo>==</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="right">Find the pixels not covered by any component.</td></tr><tr valign="top"><td>2:</td><td><inline-formula><mml:math id="inf273"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>&#8764;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">&#8592;</mml:mo><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mo>:</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="right">Run NMF on these pixels just to get temporal backgrounds <inline-formula><mml:math id="inf274"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">f</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td>3:</td><td><inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mo stretchy="false">&#8592;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mo>&#8805;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo fence="false" stretchy="false">&#8214;</mml:mo><mml:mi>Y</mml:mi><mml:mo>&#8722;</mml:mo><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">&#8214;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="right">Obtain&#160;spatial&#160;background&#160;<inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</td></tr><tr valign="top"><td>4:</td><td><inline-formula><mml:math id="inf277"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">&#8592;</mml:mo><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#8868;</mml:mi></mml:mrow></mml:msup><mml:mi>M</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#8868;</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>&#8722;</mml:mo><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="right">Initialize&#160;temporal&#160;traces.</td></tr><tr valign="top"><td>5:</td><td><inline-formula><mml:math id="inf278"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">&#8592;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>&#8805;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>&#8764;</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>==</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">&#8214;</mml:mo><mml:mi>Y</mml:mi><mml:mo>&#8722;</mml:mo><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mo>&#8722;</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mo fence="false" stretchy="false">&#8214;</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="right">Initialize spatial footprints constrained within the masks.</td></tr><tr valign="top"><td>6:</td><td><bold>repeat</bold></td><td align="right">Optionally&#160;keep&#160;updating&#160;<inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">&#119835;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">&#119839;</mml:mi></mml:mrow></mml:math></inline-formula> using&#160;HALS</td></tr><tr valign="top"><td>7:</td><td>       <inline-formula><mml:math id="inf280"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">&#8592;</mml:mo><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>&#8722;</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="right"/></tr><tr valign="top"><td>8:</td><td>       <inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">&#8592;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#8805;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo fence="false" stretchy="false">&#8214;</mml:mo><mml:mi>Y</mml:mi><mml:mo>&#8722;</mml:mo><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mo>&#8722;</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mo fence="false" stretchy="false">&#8214;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="right"/></tr><tr valign="top"><td>9:</td><td>       <inline-formula><mml:math id="inf282"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">&#8592;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>&#8805;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>&#8764;</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>==</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo fence="false" stretchy="false">&#8214;</mml:mo><mml:mi>Y</mml:mi><mml:mo>&#8722;</mml:mo><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mo>&#8722;</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mo fence="false" stretchy="false">&#8214;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="right"/></tr><tr valign="top"><td>10:</td><td><bold>until</bold> Convergence</td><td align="right"/></tr><tr valign="top"><td>11:</td><td><bold>return</bold> <inline-formula><mml:math id="inf283"><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">&#119835;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">&#119839;</mml:mi></mml:mrow></mml:math></inline-formula></td><td align="right"/></tr></tbody></table></table-wrap>