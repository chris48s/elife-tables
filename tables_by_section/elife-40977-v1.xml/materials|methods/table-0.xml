<table-wrap xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th>Algorithm 1. IF&#8211;EAKF</th></tr></thead><tbody><tr><td><bold>Input:</bold> An agent-based model <inline-formula><mml:math id="inf129"><mml:mi class="ltx_font_mathcaligraphic">&#8499;</mml:mi></mml:math></inline-formula> in a time-varying contact network <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>G</mml:mi><mml:mo>&#8290;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the number of observations <inline-formula><mml:math id="inf131"><mml:mi>T</mml:mi></mml:math></inline-formula>, incidence <inline-formula><mml:math id="inf132"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, the observational error variance (OEV) <inline-formula><mml:math id="inf133"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>&#963;</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, the initial system parameters <inline-formula><mml:math id="inf134"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">&#119859;</mml:mi><mml:mo stretchy="false">&#175;</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>&#946;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, the initial covariance matrix <inline-formula><mml:math id="inf135"><mml:mi mathvariant="normal">&#931;</mml:mi></mml:math></inline-formula>, a discount factor <inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>a</mml:mi><mml:mo>&#8712;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the&#160;number of iterations <inline-formula><mml:math id="inf137"><mml:mi>L</mml:mi></mml:math></inline-formula>.<break/><bold>for</bold>&#160;<inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf139"><mml:mi>L</mml:mi></mml:math></inline-formula>&#160;<bold>do<break/></bold>      Generate an ensemble of parameter vectors with <inline-formula><mml:math id="inf140"><mml:mi>n</mml:mi></mml:math></inline-formula> members using a multivariate Gaussian distribution: <inline-formula><mml:math id="inf141"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">&#119859;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>&#8764;</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">&#119977;</mml:mi><mml:mo>&#8290;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">&#119859;</mml:mi><mml:mo stretchy="false">&#175;</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#8290;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>&#8290;</mml:mo><mml:mi mathvariant="normal">&#931;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.<break/>      <bold>for</bold>&#160;<inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf143"><mml:mi>T</mml:mi></mml:math></inline-formula>&#160;<bold>do<break/></bold>              Run the agent-based model <inline-formula><mml:math id="inf144"><mml:mi class="ltx_font_mathcaligraphic">&#8499;</mml:mi></mml:math></inline-formula> with posterior <inline-formula><mml:math id="inf145"><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">&#119859;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> obtained from last update for one week, and return the ensemble of incidence: <inline-formula><mml:math id="inf146"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">&#8499;</mml:mi><mml:mo>&#8290;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">&#119859;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.<break/>              Update the prior distribution of parameters <inline-formula><mml:math id="inf147"><mml:mi>&#946;</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>&#8801;</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> to posterior <inline-formula><mml:math id="inf150"><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">&#119859;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> using the EAKF, <inline-formula><mml:math id="inf151"><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf152"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>&#963;</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf153"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. Individual states are evolved per the agent-based model and are not updated by the EAKF.<break/>       <bold>end for</bold><break/>        Calculate the ensemble mean of the posterior over time as the input in next iteration:<break/><inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mo stretchy="false">&#175;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf155"><mml:mi>E</mml:mi></mml:math></inline-formula> computes the ensemble mean.<break/><bold>end for<break/>Output:</bold>&#160;<inline-formula><mml:math id="inf156"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">&#119859;</mml:mi><mml:mo stretchy="false">&#175;</mml:mo></mml:mover><mml:mi>L</mml:mi></mml:msup></mml:math></inline-formula> as the MLE of the parameter vector.</td></tr></tbody></table></table-wrap>