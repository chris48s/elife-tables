<table-wrap xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th valign="top"><bold>Algorithm 1</bold>: SeqNMF (x-ortho algorithm)</th></tr></thead><tbody><tr><td valign="top">&#160;&#160;&#160;<bold>&#160;Input</bold>: Data matrix <inline-formula><mml:math id="inf448"><mml:mi mathvariant="bold">&#119831;</mml:mi></mml:math></inline-formula>, number of factors <inline-formula><mml:math id="inf449"><mml:mi>K</mml:mi></mml:math></inline-formula>, factor duration <inline-formula><mml:math id="inf450"><mml:mi>L</mml:mi></mml:math></inline-formula>, regularization <break/>                  strength <inline-formula><mml:math id="inf451"><mml:mi>&#955;</mml:mi></mml:math></inline-formula><break/>&#160;&#160;&#160;&#160;<bold>Output</bold>: Factor exemplars <inline-formula><mml:math id="inf452"><mml:mi mathvariant="bold">&#119830;</mml:mi></mml:math></inline-formula>, factor timecourses <inline-formula><mml:math id="inf453"><mml:mi mathvariant="bold">&#119815;</mml:mi></mml:math></inline-formula><break/>1 Initialize <inline-formula><mml:math id="inf454"><mml:mi mathvariant="bold">&#119830;</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf455"><mml:mi mathvariant="bold">&#119815;</mml:mi></mml:math></inline-formula> randomly <break/>2 Iter&#160;=&#160;1 <break/>3 <bold>While&#160;</bold>(Iter <inline-formula><mml:math id="inf456"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> maxIter) and (<inline-formula><mml:math id="inf457"><mml:mi mathvariant="normal">&#916;</mml:mi></mml:math></inline-formula> cost <inline-formula><mml:math id="inf458"><mml:mo>&gt;</mml:mo></mml:math></inline-formula> tolerance) <bold>do</bold><break/>4&#160;      Update <inline-formula><mml:math id="inf459"><mml:mi mathvariant="bold">&#119815;</mml:mi></mml:math></inline-formula> using multiplicative update from <xref ref-type="table" rid="table2">Table 2</xref> <break/>5&#160;      Shift <inline-formula><mml:math id="inf460"><mml:mi mathvariant="bold">&#119830;</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf461"><mml:mi mathvariant="bold">&#119815;</mml:mi></mml:math></inline-formula> to center <inline-formula><mml:math id="inf462"><mml:mi mathvariant="bold">&#119830;</mml:mi></mml:math></inline-formula>&#8217;s in time <break/>6&#160;      Renormalize <inline-formula><mml:math id="inf463"><mml:mi mathvariant="bold">&#119830;</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf464"><mml:mi mathvariant="bold">&#119815;</mml:mi></mml:math></inline-formula> so rows of <inline-formula><mml:math id="inf465"><mml:mi mathvariant="bold">&#119815;</mml:mi></mml:math></inline-formula> have unit norm <break/>7&#160;      Update <inline-formula><mml:math id="inf466"><mml:mi mathvariant="bold">&#119830;</mml:mi></mml:math></inline-formula> using multiplicative update from <xref ref-type="table" rid="table2">Table 2</xref> <break/>8&#160;      Iter =&#160;Iter&#160;+&#160;1<break/>9 Do one final unregularized convNMF update of <inline-formula><mml:math id="inf467"><mml:mi mathvariant="bold">&#119830;</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf468"><mml:mi mathvariant="bold">&#119815;</mml:mi></mml:math></inline-formula><break/>10 <bold>return</bold></td></tr></tbody></table></table-wrap>